<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste da API Spring Boot</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f4; }
        form { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        div { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 300px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #resposta { background: #333; color: #fff; padding: 15px; border-radius: 4px; margin-top: 20px; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>

    <h1>Teste Rápido da API: Criar Cliente</h1>
    <p>Este formulário envia um <strong>POST</strong> para <code>http://localhost:8080/api/clientes</code></p>

    <form id="formCliente">
        <div>
            <label for="nome">Nome:</label>
            <input type="text" id="nome" value="Cliente de Teste HTML">
        </div>
        <div>
            <label for="cpf">CPF:</label>
            <input type="text" id="cpf" value="12345678900">
        </div>
        <div>
            <label for="dataNascimento">Data Nascimento (AAAA-MM-DD):</label>
            <input type="text" id="dataNascimento" value="2000-01-01">
        </div>
        <div>
            <label for="endereco">Endereço:</label>
            <input type="text" id="endereco" value="Rua dos Testes, 123">
        </div>
        <button type="submit">Salvar (Enviar POST)</button>
    </form>

    <h2>Resposta do Servidor:</h2>
    <pre id="resposta">(Aguardando envio...)</pre>

    <script>
        // Adiciona um "ouvinte" ao formulário
        document.getElementById('formCliente').addEventListener('submit', async function(evento) {
            
            // Impede o formulário de recarregar a página
            evento.preventDefault(); 
            
            const areaResposta = document.getElementById('resposta');
            areaResposta.textContent = 'Enviando...';

            // 1. Pega os dados do formulário
            const dadosDoForm = {
                nome: document.getElementById('nome').value,
                cpf: document.getElementById('cpf').value,
                dataNascimento: document.getElementById('dataNascimento').value,
                endereco: document.getElementById('endereco').value
            };

            // 2. Tenta enviar a requisição (o "fetch" é o Postman do navegador)
            try {
                const resposta = await fetch('http://localhost:8080/api/clientes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json' // Diz que estamos enviando JSON
                    },
                    body: JSON.stringify(dadosDoForm) // Converte o objeto em texto JSON
                });

                // 3. Pega a resposta (seja sucesso ou erro)
                const dadosResposta = await resposta.json();
                
                // Se a resposta NÃO for OK (ex: erro 400, 404, 500)
                if (!resposta.ok) {
                    // Pega a mensagem de erro que o Spring enviou (ex: "CPF já existe")
                    areaResposta.style.color = '#ff9a9a';
                    areaResposta.textContent = `Erro ${resposta.status}: ${JSON.stringify(dadosResposta, null, 2)}`;
                } else {
                    // Se deu tudo certo (201 Created)
                    areaResposta.style.color = '#a0ffa0';
                    areaResposta.textContent = `Sucesso (Status ${resposta.status}):\n\n${JSON.stringify(dadosResposta, null, 2)}`;
                }

            } catch (erro) {
                // Erro de rede (ex: o servidor Spring não está rodando)
                areaResposta.style.color = 'red';
                areaResposta.textContent = 'Erro de rede! A API está rodando?\n' + erro.message;
            }
        });
    </script>

</body>
</html>